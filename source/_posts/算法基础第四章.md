---
title: æ•°å­¦çŸ¥è¯†ï¼ˆACwingï¼‰
categories: ACWing
date: 2024-5-1 16:28:45
tags: ç®—æ³•åŸºç¡€





---

# æ•°å­¦çŸ¥è¯†

<!--more-->

# ä¸€ã€è¯•é™¤æ³•

## 1ã€åˆ†è§£è´¨å› æ•°

###### è´¨æ•°ï¼šåªèƒ½è¢«1å’Œè‡ªèº«æ•´é™¤çš„æ•°

```
void div(int x){
    for(int i=2;i*i <= x;++i){
        if(x%i == 0){
            int s = 0;
            while(x%i == 0){
                x/=i;++s;ã€
            } 
            cout << i << " " << s << endl;//è´¨å› æ•°iå‡ºç°äº†sæ¬¡
        }
    }
    if(x > 1) cout << x << " " << 1 << endl;//é¢å¤–è€ƒè™‘çš„x
    cout << endl;
}
```

## 2ã€çº¦æ•°ä¸ªæ•°

###### çº¦æ•°ï¼šä¸€ä¸ªæ•°çš„æ‰€æœ‰å› å­

###### çº¦æ•°ä¸ªæ•° = æ‰€æœ‰è´¨å› å­å‡ºç°çš„(å¹‚æ¬¡+1)ä¹˜ç§¯

```
ä¾‹å¦‚ 12
è´¨å› å­ 2ï¼ˆ2æ¬¡ï¼‰ 3ï¼ˆ1æ¬¡ï¼‰
çº¦æ•°ä¸ªæ•° = (2+1)*(1+1) = 3*2=6

-> 1 2 3 4 6 12
```

æ ¸å¿ƒä»£ç 

```
map<int,int>check;//å­˜å‚¨è´¨å› æ•°å‡ºç°æ¬¡æ•°
void div(int x){//è¯•é™¤æ³•
    for(int i = 2; i * i <= x; i++){
        while(x % i == 0) x /= i, ++check[i];
    }
    if(x > 1) ++check[x]; 
}
```

ç»“æœï¼š

```
 for(auto it:check){
        ans = (ans*(it.second+1))%N;
    }
```

## 3ã€çº¦æ•°ä¹‹å’Œ

###### çº¦æ•°ä¹‹å’Œ =  æ‰€æœ‰è´¨å› å­çš„ç­‰æ¯”æ•°åˆ—å’Œçš„ä¹˜ç§¯

```
ä¾‹å¦‚ 12
è´¨å› å­  2ï¼ˆ2æ¬¡ï¼‰ 3ï¼ˆ1æ¬¡ï¼‰
çº¦æ•°ä¹‹å’Œ = ï¼ˆ2^0+2^1+2^2ï¼‰* (3^0+3^1) = 28
1+2+3+4+6+12 = 28
```

æ ¸å¿ƒä»£ç 

```
void div(int x){
    for(int i=2;i*i<=x;i++){
        while(x%i == 0){
            x/=i;
            ++check[i];
        }
    }
    if(x > 1) ++check[x];
}
```

è¿™é‡Œå¯ä»¥ç”¨å¿«é€Ÿå¹‚

```
 for(auto it:check){
        ll tmp = 0;
        int p = it.first;
        int k = it.second;
        ll pk = 1;
        for(int i=0;i<=k;i++){
            tmp = (tmp + pk) % N; // ä½¿ç”¨ä¹˜æ³•å…¬å¼è®¡ç®—çº¦æ•°å’Œ
            pk = (pk * p) % N; // ä½¿ç”¨å¿«é€Ÿå¹‚è®¡ç®— p^k
        }
        ans = (tmp * ans) % N; // è®¡ç®—æœ€ç»ˆç»“æœ
    }
```

## 4ã€æ¬§æ‹‰å‡½æ•°

###### ç”¨é€” ï¼šæ±‚1-nä¹‹é—´çš„äº’è´¨æ•°å¯¹æ•°é‡

###### äº’è´¨ï¼šæœ€å¤§å…¬çº¦æ•° = 1

æ ¸å¿ƒä»£ç 

```
void div(int x){//æ¬§æ‹‰å‡½æ•°
    int result = x;
    for(int i=2;i*i<=x;i++){
        if(x%i == 0){
            while(x%i == 0) x/=i;
            result -= result/i;
        }
    }
    if(x > 1) result -= result/x;
    cout << result << endl;
}
```

## 5ã€ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°

æ ¸å¿ƒä»£ç ï¼šæ‰“è¡¨

```
vector<int> ol(n + 1); // içš„æ¬§æ‹‰æ•°ä¸ºol[i]
    for (int i = 1; i <= n; i++) // åˆå§‹åŒ–
        ol[i] = i;

    for (int i = 2; i <= n; i++) {
        if (ol[i] == i) { // å¦‚æœiè¿˜æœªè¢«æ”¹åŠ¨
            for (int j = i; j <= n; j += i) {
                ol[j] = ol[j] / i * (i - 1);
            }
        }
        ans += ol[i];
    }
```

# äºŒã€å¿«é€Ÿå¹‚

###### æ¯”powerå¿«ï¼

æ ¸å¿ƒä»£ç 

```
ll power(ll x,ll p,ll mod){
    ll ans = 1;
    while(p){
        if(p&1) ans = ans*x%mod;
        x  = x*(ll)x%mod;
        p >>= 1;
    }
    return ans;
}
```

# ä¸‰ã€åŒä½™ä¸é€†å…ƒ

###### åŒä½™ï¼š

```
å¼å­ï¼šğ‘ â‰¡ ğ‘ (mod ğ‘š)

å«ä¹‰ï¼šåœ¨æ•´æ•°ä¹‹é—´ï¼Œå¦‚æœå®ƒä»¬é™¤ä»¥ä¸€ä¸ªç»™å®šçš„æ­£æ•´æ•°å¾—åˆ°çš„ä½™æ•°ç›¸åŒï¼Œåˆ™è¿™ä¸¤ä¸ªæ•´æ•°è¢«ç§°ä¸ºåŒä½™

å³ï¼š a%m == b%m
```

###### é€†å…ƒ: 

```
å¼å­ï¼š ğ‘ * ğ‘¥ â‰¡ 1 (mod ğ‘š)
å«ä¹‰ï¼šè‹¥å­˜åœ¨ä¸€ä¸ªxæ»¡è¶³å¼å­ï¼Œé‚£ä¹ˆç§°xæ˜¯aåœ¨æ¨¡mä¸‹çš„é€†å…ƒ
```

psï¼šå¯èƒ½æ˜¯è´Ÿæ•°çš„å€¼çš„å–æ¨¡æ–¹æ³•

```
x = (x%N + N)%N
```



## 1ã€æ¬§å‡ é‡Œå¾—ç®—æ³•

###### ä½œç”¨ï¼šæ±‚aå’Œbçš„æœ€å¤§å…¬çº¦æ•°

###### æ ¸å¿ƒä»£ç 

```
int gcd(int x,int y){
    if(y == 0) return x;
    return gcd(y,x%y);
}
```

## 2ã€æ‰©å±•æ¬§å‡ é‡Œå¾—

###### ä½œç”¨ï¼š

###### 1ã€æ±‚è§£ä¸¤ä¸ªæ•´æ•°çš„æœ€å¤§å…¬çº¦æ•° ğ‘‘å’Œä½¿å¾— ğ‘ğ‘¥+ğ‘ğ‘¦=ğ‘‘ æˆç«‹çš„æ•´æ•°è§£ ğ‘¥å’Œ ğ‘¦çš„ç®—æ³•

æ ¸å¿ƒä»£ç 

```
int exgcd(int a,int b,int& x,int& y){//æ±‚è§£ä¸¤ä¸ªæ•´æ•°çš„æœ€å¤§å…¬çº¦æ•° ğ‘‘å’Œä½¿å¾— ğ‘ğ‘¥+ğ‘ğ‘¦=ğ‘‘ æˆç«‹
    if(b == 0){
      x = 1;
      y = 0;
      return a;
    } 
    int ans = gcd(b,a%b,x1,y1);
    int tmp = x;
    x = y;
    y = tmp -a/b*y;
    return ans;
}
```

### æ±‚è§£çº¿æ€§åŒä½™æ–¹ç¨‹ ğ‘*ğ‘¥ â‰¡ ğ‘(mod ğ‘š) çš„è§£ 

```
#include<iostream>
using namespace std;
using ll = long long;

int exgcd(int a,int b,int &x,int &y){//æ³¨æ„ï¼Œå¸¦å…¥çš„æ˜¯a,m;
    if(b==0){
        x = 1,y = 0;
        return a;
    }
    int ans = exgcd(b,a%b,x,y);

    int tmp = x;
    x = y;
    y = tmp -a/b*y;

    return ans;
}

int main(){
    int n;
    cin>>n;
    while(n--){
        int a,b,m;
        cin >> a >> b >> m;
        int x,y;
        int d = exgcd(a,m,x,y);
        //å½“ ğ‘å’Œ ğ‘š äº’è´¨æ—¶ï¼Œæ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ç”¨äºæ±‚è§£ ğ‘åœ¨æ¨¡ ğ‘šä¸‹çš„é€†å…ƒ
        //å½“ ğ‘å’Œ ğ‘šä¸äº’è´¨æ—¶ï¼Œå¯ä»¥é€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å°†çº¿æ€§åŒä½™æ–¹ç¨‹è½¬æ¢ä¸ºç­‰ä»·çš„å¯ä»¥æ±‚è§£é€†å…ƒçš„å½¢å¼
        if(b%d == 0){
            int t = b/d;
            int N = m/d;
            cout << ((ll)x*t%N+N)%N << endl;//b/d*x æ˜¯açš„é€†å…ƒ
        }
        else
            cout << "impossible" << endl;
    }
    return 0;
}
```

## 3ã€è´¹é©¬å°å®šç†

```
1. å¯ç”¨äºåˆ¤æ–­ç´ æ•°ã€‚å¦‚æœ p ä¸æ˜¯ç´ æ•°ï¼Œåˆ™è´¹é©¬å°å®šç†ä¸æˆç«‹ã€‚

2. å¯ç”¨äºæ±‚è§£æ¨¡ p ä¸‹çš„é€†å…ƒã€‚å½“ p æ˜¯ç´ æ•°æ—¶ï¼Œa^pâˆ’2æ˜¯ a åœ¨æ¨¡ p ä¸‹çš„é€†å…ƒã€‚

3. å¯ç”¨äºç®€åŒ–å¹‚çš„è®¡ç®—ã€‚
```



### å¿«é€Ÿå¹‚è§£é€†å…ƒ

```
#include<iostream>
using namespace std;
using ll = long long;

ll power(ll x,ll p,ll mod){
    ll ans = 1;
    while(p){
        if(p&1) ans = ans*x%mod;
        x  = x*(ll)x%mod;
        p >>= 1;
    }
    return ans;
}

int main(){
    int n;
    cin >> n;
    while(n--){
        ll a,p;
        cin >> a >> p;
        ll ans = power(a,p-2,p);
        if(a%p == 0) cout << "impossible" << endl;//aæ˜¯pçš„å€æ•°ï¼Œé€†å…ƒä¸å­˜åœ¨
        else cout << ans << endl;
    }
    return 0;
}
```

## 4ã€ä¸­å›½å‰©ä½™å®šç†